# Bifrost Benchmark Configuration
# 5 memcached servers with least_latency strategy and connection pooling

listeners:
  main:
    bind: "0.0.0.0:22122"

# Individual backend servers (5 memcached instances) with connection pooling
backends:
  cache1:
    type: "memcached"
    server: "memcached1:11211"
    connection_pool:
      min_connections: 50     # Keep more connections warm for high concurrency
      max_connections: 500    # Allow more concurrent connections
      connection_timeout_secs: 10
      idle_timeout_secs: 600  # 10 minutes
      max_lifetime_secs: 7200 # 2 hours

  cache2:
    type: "memcached"
    server: "memcached2:11211"
    connection_pool:
      min_connections: 50
      max_connections: 500
      connection_timeout_secs: 10
      idle_timeout_secs: 600
      max_lifetime_secs: 7200

  cache3:
    type: "memcached"
    server: "memcached3:11211"
    connection_pool:
      min_connections: 50
      max_connections: 500
      connection_timeout_secs: 10
      idle_timeout_secs: 600
      max_lifetime_secs: 7200

  cache4:
    type: "memcached"
    server: "memcached4:11211"
    connection_pool:
      min_connections: 50
      max_connections: 500
      connection_timeout_secs: 10
      idle_timeout_secs: 600
      max_lifetime_secs: 7200

  cache5:
    type: "memcached"
    server: "memcached5:11211"
    connection_pool:
      min_connections: 50
      max_connections: 500
      connection_timeout_secs: 10
      idle_timeout_secs: 600
      max_lifetime_secs: 7200

# Least-latency pool with all 5 backends
pools:
  benchmark_pool:
    backends: ["cache1", "cache2", "cache3", "cache4", "cache5"]
    strategy:
      type: "least_latency"

routes:
  # Default route - all traffic goes to round robin pool
  default:
    matcher: "*"
    pool: "benchmark_pool"